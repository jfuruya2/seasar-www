<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- don't edit start -->
<head><title>Seasar - DI Container with AOP - </title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<link href="../seasar_b.css" type="text/css" rel="stylesheet" media="screen"><script src="seasar_b.js" type="text/JavaScript" language="JavaScript"></script>
</head>
<BODY onload="preload('en')">
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=left border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=left width=780>
      <TABLE class=white cellSpacing=0 cellPadding=0 width=780 border=0>
        <TBODY>
        <TR>
          <TD colSpan=7><IMG height=5 alt="" 
            src="../images/top01_b.gif" width=780></TD></TR>
        <TR>
          <TD width=235><IMG height=117 alt=Seasar 
            src="../images/top02_b.gif" width=235></TD>
          <TD colSpan=3><IMG height=117 alt="DI Container with AOP" 
            src="../images/top03.gif" width=289></TD>
          <TD colSpan=3><IMG height=117 alt="" 
            src="../images/spacer.gif" width=256></TD></TR>
<tr><td rowspan="2"><img src="../images/top04.gif" alt="" height="49" width="235"></td>
<td><a href="../index.html"><img src="../images/menu01_b_en.gif" height="30" width="78" border="0" alt="" id="menu01" onmouseover="swap(1)" onmouseout="restore(1)"></a></td>
<td><a href="../projects.html"><img src="../images/menu02_b_en.gif" height="30" width="101" border="0" alt="" id="menu02" onmouseover="swap(2)" onmouseout="restore(2)"></a></td>
<td><a href="../products.html"><img src="../images/menu06_b_en.gif" height="30" width="110" border="0" alt="" id="menu06" onmouseover="swap(6)" onmouseout="restore(6)"></a></td>
<td><a href="../documents.html"><img src="../images/menu04_b_en.gif" height="30" width="109" border="0" alt="" id="menu04" onmouseover="swap(4)" onmouseout="restore(4)"></a></td>
<td><a href="../resources.html"><img src="../images/menu05_b_en.gif" height="30" width="113" border="0" alt="" id="menu05" onmouseover="swap(5)" onmouseout="restore(5)"></a></td>
<!--
<td><img src="../images/menu07_b_en.gif" height="30" width="109" border="0" alt=""  id="menu07" onmouseover="swap(7)" onmouseout="restore(7)"></td>
//-->
<td><img height="30" width="34" src="../images/menu06.gif" alt=""></td></tr><tr>
        <TR>
          <TD colSpan=6><IMG height=19 alt="" 
            src="../images/spacer.gif" width=545></TD></TR></TBODY></TABLE>
      <TABLE class=white cellSpacing=0 cellPadding=0 width=780 border=0>
        <TBODY>
        <TR vAlign=top align=left>
          <TD width=18><IMG height=14 alt="" 
            src="../images/spacer.gif" width=18></TD>
          <TD class=main width=744><!-- don't edit end --><!-- document start -->
            <CENTER>S2Container.PHP5 is a port of Java version Seasar2 to PHP5.<BR>For detailed information about the DIContainer, refer to <A 
            href="http://s2container.seasar.org/en/DIContainer.html">S2Container</A>.<BR></CENTER>
            <UL>
              <LI><A 
              href="#S2ContainerReference">S2Container Reference</A> 
              <UL>
                <LI><A href="#CreateFile">Required Files</A> 
                <LI><A href="#S2ContainerDefinition">S2Container Definition</A> 
                <LI><A href="#S2ContainerCreation">S2Container Creation</A> 
                <LI><A href="#getComponent">Getting a Component</A> 
                <LI><A href="#DIType">Dependency Injection Types</A> 
                <UL>
                  <LI type=circle><A href="#ConstructorInjection">Constructor Injection</A> 
                  <LI type=circle><A href="#SetterInjection">Settter Injection</A> 
                  <LI type=circle><A href="#MethodInjection">Method Injection</A> 
                  </LI></UL>
                <LI><A href="#Include">Dividing and Including S2Container Definition</A> 
                <LI><A href="#Namespace">Namespace</A> 
                <LI><A  href="#InstanceMode">Instance Management</A> 
                <LI><A href="#Lifecycle">Lifecycle</A> 
                <LI><A href="#AutoBindingMode">Automatic Binding</A> 
                <LI><A href="#UseS2Container">Using S2Container from a Component</A>
                <LI><A href="#Aop">Applying AOP</A> 
                <LI><A href="#Meta">MetaData</A> 
                </LI></UL>
              <LI><A  href="#DefReference">S2Container Definition Reference</A> 
              <UL>
                <LI><A href="#DOCTYPE">DOCTYPE</A> 
                <LI><A href="#componentsTag">components Tag</A> 
                <LI><A href="#includeTag">include Tag</A> 
                <LI><A href="#componentTag">component Tag</A> 
                <LI><A href="#argTag">arg Tag</A> 
                <LI><A  href="#propertyTag">property Tag</A> 
                <LI><A href="#metaTag">meta Tag</A> 
                <LI><A href="#initMethodTag">initMethod Tag</A> 
                <LI><A href="#destroyMethodTag">destroyMethod Tag</A> 
                <LI><A href="#aspectTag">aspect Tag</A> 
                <LI><A href="#descriptionTag">description Tag</A> 
                </LI></UL>
              <LI><A href="#Example">Examples</A> 
              <UL>
                <LI><A href="#ConstructorInjectionEx">Constructor Injection</A> 
                <LI><A  href="#SetterInjectionEx">Setter Injection</A>
                <LI><A href="#MethodInjectionEx">Method Injection</A> 
                <LI><A href="#AutoConstructorInjectionEx">Automatic Binding (Constructor Injection)</A> 
                <LI><A  href="#AutoSetterInjectionEx">Automatic Binding (Setter Injection)</A> 
                </LI></UL></LI></UL><BR><A name=S2ContainerReference>
            <H2>S2Container Reference</H2></A><A name=CreateFile><B>
            <H3>Required Files</H3></B></A>
            <P>Configuration file is required to use S2Container. Configuration file is a specification to build components. Configuration file may be automatically generated by S2 by following S2 programming convention or created manually. Configuration file may be written in  XML format and in <A href="extension.html#ini-dicon">PHP configuration file format</A> (INI format). File extension of a XML format file may be <span class="enter">.dicon</span> or <span class="enter">.xml</span>. File extension of a <A href="extension.html#ini-dicon">PHP configuration file</A> is <span class="enter">.ini</span>. Seasar configuration files are usually written in XML format to be compatible with other versions of Seasar (i.e. Java version and .NET version) and have <span class="enter">.dicon</span> extension.</P><A name=S2ContainerDefinition><B>
            <H3>S2Container Definition</H3></B></A>
            <P>S2Container is defined as follows:</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component name="..." class="..."&gt;
            ...
    &lt;/component&gt;
    &lt;component name="..." class="..."&gt;
            ...
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <P>DOCTYPE may not be omitted. When creating a dicon file, cut and paste the above sample. Root element is a <A href="#componentsTag">component</A>. Each component is defined by a <A href="#componentTag">component</A> tag and class name is defined in a class attribute of a component tag. Component name is defined in a name attribute of a component. Refer to <A href="#DefReference">S2Container Definition Reference</A> for further details.</P><PRE>&lt;components&gt;
    &lt;component name="hoge" class="HogeImpl"/&gt;
&lt;/components&gt;
</PRE><A name=S2ContainerCreation>
            <H3>Creating a S2Container</H3></A>
            <P>Following methods are used to create a S2Container:</P>
            <P>- S2ContainerFactory#create(<SPAN class="enter">$path</SPAN>)</P>Argument <SPAN class="enter">$path</SPAN> is a path to the configuration file<PRE>&lt;?php
$PATH = "path/to/ccc.dicon";
...
$container = S2ContainerFactory::create($PATH);
?&gt;
</PRE><A name=getComponent>
            <H3>Getting a Component</H3></A>
            <P>Following method is used to get a component from the S2Container:</P>
            <P>- S2Container#getComponent(<SPAN class="enter">$componentKey</SPAN>)</P>Argument <SPAN class="enter">$componentKey</SPAN> is a component class or a component name of component to get. Refer to <A href="#componentTag">component Tag</A> for further details. Component class where instanceof class is true may be gotten from the container. The class, however, should be associated with an unique component in the S2Container. If there are several components of the class, TooManyRegistrationRuntimeException is raised because S2Container can not determine which component to get.<BR />
Similarly, component name should be unique in the S2Container. Specifying non-unique component name will raise a TooManyRegistrationRuntimeException.<BR><BR>
            <P>Example: Following defines component named "hoge" of class "Hoge"<PRE>&lt;components&gt;
    &lt;component name="hoge" class="Hoge"/&gt;
&lt;/components&gt;
</PRE>
            <P>Following code gets the component "hoge" by specifying class "Hoge":</P><PRE>&lt;?php
$container = S2ContainerFactory::create($PATH);
$hoge = $container-&gt;getComponent('Hoge');
?&gt;
</PRE>
            <P>Following code gets the component "hoge" by specifying component name "hoge":</P><PRE>&lt;?php
$container = S2ContainerFactory::create($PATH);
$hoge = $container-&gt;getComponent('hoge');
?&gt;
</PRE><A name=DIType>
            <H3>Dependency Injection types</H3></A>Following is a list of DependencyInjection types:
            <TABLE cellSpacing=0 cellPadding=0 border=0 hspace="0" vspace="0">
              <TBODY>
              <TR>
                <TD>ConstructorInjection</TD>
                <TD>:</TD>
                <TD>Use a constructor to set values necessary to construct a component</TD>
              <TR>
              <TR>
                <TD>SetterInjection</TD>
                <TD>:</TD>
                <TD>Use a setter method to set values necessary to construct a component</TD>
              <TR>
              <TR>
                <TD>MethodInjection</TD>
                <TD>:</TD>
                <TD>Use initialization method to set values necessary to construct a component</TD>
              <TR></TR></TBODY></TABLE> MethodInjection is S2 original DependencyInjection type. All S2 types and their hybrid types are supported.
            <A name=ConstructorInjection><B>
            <H3>Constructor Injection</H3></B></A>
            <P>Constructor injection injects dependency through a constructor by using constructor arguments.<BR>It is written in a S2Container configuration file as follows:</P>
            <UL>
              <LI><B>Component specification</B><BR>Component is specified using <SPAN class="enter">component</SPAN> tag. Class name is set in <SPAN class="enter">class</SPAN> attribute and component name may be set in <SPAN class="enter">name</SPAN> attribute.
              <LI><B>Constructor arguments</B><BR>Arguments to a constructor are set in <SPAN class="enter">arg</SPAN> elements that are child elements of a component tag.<BR>When the value of an argument is of type String, it is surrounded by double quotation (<SPAN class="enter">&quot;</SPAN>).
              </LI></UL><PRE>&lt;components&gt;
    &lt;component name="..." class="..."&gt;
          &lt;arg&gt;...&lt;/arg&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>Refer to example in <A href="#ConstructorInjectionEx">Constructor injection</A> for details.<BR><BR><A 
            name=SetterInjection><B>
            <H3>Setter Injection</H3></B></A>
            <P>Setter injection injects dependencies (properties) by using setter methods.<BR>It is written in a S2Container configuration file as follows:</P>
            <UL>
              <LI><B>Component specification</B><BR>Component is specified using <SPAN class="enter">component</SPAN> tag. Class name is set in <SPAN class="enter">class</SPAN> attribute and component name may be set in <SPAN class="enter">name</SPAN> attribute.
              <LI><B>Properties</B><BR>Component parameters are set in <SPAN class="enter">property</SPAN> elements that are child elements of a component tag.<BR />Name of a property is specified using <SPAN class="enter">name</SPAN> attribute.
              </LI></UL><PRE>&lt;components&gt;
    &lt;component name="..." class="..."&gt;
          &lt;property name="..."&gt;...&lt;/property&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
Refer to <A href="#SetterInjectionEx">Setter Injection</A> example for an example.<BR><A name=MethodInjection><B>
            <H3>Method Injection</H3></B></A>
            <P>Method injection injects  by invoking an arbitrary method.<BR>It is defined in a S2Container configuration file as follows:<BR>It is written in a S2Container configuration file as follows:</P>
            <UL>
              <LI><B>Component specification</B><BR>Component is specified using <SPAN class="enter">component</SPAN> tag. Class name is set in <SPAN class="enter">class</SPAN> attribute and component name may be set in <SPAN class="enter">name</SPAN> attribute.
              <LI><B>Initialization method</B><BR>Name and argument of method to invoke is set in a <SPAN class="enter">initMethod</SPAN> elements that are child elements of a component tag.<BR />Name of a property is specified using <SPAN class="enter">name</SPAN> attribute to this initMethod element. Arguments to the method to invoke is specified as values to <SPAN class="enter">arg</SPAN> element which is a child of a initMethod element.
              </LI></UL><PRE>&lt;components&gt;
    &lt;component name="..." class="..."&gt;
          &lt;initMethod name="..."&gt;
             &lt;arg&gt;...&lt;/arg&gt;
          &lt;/initMethod&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
When there is no argument, name attribute may be omitted and the name of the method may be set by a PHP expression as the value of initMethod element. In this situation, component is represented by $component.
<PRE>&lt;components&gt;
    &lt;component name="..." class="..."&gt;
          &lt;initMethod&gt;...&lt;/initMethod&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
Refer to <A href="#MethodInjectionEx">Method Injection</A> example for an example.<BR><A name=Include>
            <H3>Dividing and Including S2Container Definition</H3></A>
            <P>If all configuration are written in a single file, the file soon becomes very large. S2Container allows developers to divide the configuration file into several files and supports include clause to logically construct one configuration file from these files. Following is an example of including content of bar.dicon file.</P><PRE>&lt;components&gt;
    &lt;include path="bar.dicon"/&gt;
&lt;/components&gt;
</PRE>
            <P>File to include is specified in the path attribute of a <A href="#includeTag">include tag</A>. Refer to <A href="#includeTag">include tag</A> for detailed information.<BR>Component are searched in the following order: (1) In the component where the component is registered (2) In child S2Container in order of the include statement.<BR>In the following components definition, "Foo" is searched first, followed by "aaa.dicon" and lastly by "bbb".</P><PRE>&lt;components&gt;
    &lt;include path="aaa.dicon"/&gt;
    &lt;include path="bbb.dicon"/&gt;
    &lt;component class="Foo" /&gt;
&lt;/components&gt;
</PRE>
            <P>When automatically using <A href="#ConstructorInjection">constructor injection</A> and <A href="#SetterInjection">setter injection</A>, it is possible to automatically inject components in configuration to be included. Refer to <A href="#AutoBindingMode">automatic binding</A> for conditions to automatically inject dependencies.<BR>
Following is an example to show the order of component search. Property of a component  to set by setter injection (HelloImpl) is defined in both included configuration files aaa.dicon and bbb.dicon. Let's find out which component HelloClient will use.</P>
            <H5>root.dicon</H5><PRE>&lt;components&gt;
    &lt;include path="aaa.dicon"/&gt;
    &lt;include path="bbb.dicon"/&gt;
    &lt;component name="root" class="RootHelloClient"/&gt;
&lt;/components&gt;
</PRE>
            <H5>aaa.dicon</H5><PRE>&lt;components&gt;
    &lt;component class="HelloImpl"&gt;
        &lt;property name="message"&gt;"Hello Aaa!"&lt;/property&gt;
    &lt;/component&gt;

    &lt;component name="aaa" class="AaaHelloClient"/&gt;
&lt;/components&gt;
</PRE>
            <H5>bbb.dicon</H5><PRE>&lt;components&gt;
    &lt;component class="HelloImpl"&gt;
        &lt;property name="message"&gt;"Hello Bbb!"&lt;/property&gt;
    &lt;/component&gt;

    &lt;component name="bbb" class="BbbHelloClient"/&gt;
&lt;/components&gt;
</PRE>
            <P>Content of each component is as follows:</P><PRE>&lt;?php
interface HelloClient {
    public function showMessage();
}
?&gt;
</PRE><PRE>&lt;?php
class RootHelloClient implements HelloClient {

    private $hello_;

    public function setHello(Hello $hello) {
        $this-&gt;hello_ = $hello;
    }

    public function getHello() {
        return $this-&gt;hello_;
    }

    public function showMessage() {
        print $this-&gt;getHello()-&gt;getMessage();
    }
}
?&gt;
</PRE>
            <P>Implementation of AaaHelloClient and BbbHelloClient is like those of RootHelloClient.</P><PRE>&lt;?php
interface Hello {
    public function setMessage($helloMessage);
    public function getMessage();
}
?&gt;
</PRE><PRE>&lt;?php
class HelloImpl implements Hello {
    private $helloMessage_;

    public function setMessage($helloMessage) {
        $this-&gt;helloMessage_ = $helloMessage;
    }

    public function getMessage() {
        return $this-&gt;helloMessage_;
    }
}
?&gt;
</PRE>
            <P>HelloImpl only defines Message property. Following are result of invoking showMessage() method in each HelloClient.</P>
            <H5>Result of RootHelloClient</H5><PRE>Hello Aaa!
</PRE>
            <P>S2Container will first try to find HelloImpl in root.dicon. Since HelloImpl is not defined in root.dicon, S2Container will next try to find it in the first included file, aaa.dicon. Since HelloImpl is defined in aaa.dicon, this definition is used and "Hello Aaa!" is outputted.</P>
            <H5>Result of AaaHelloClient</H5><PRE>Hello Aaa!
</PRE>
            <P>AaaHelloClient used HelloImpl defined in aaa.dicon. When injection is automatically done, child S2Container is unable to use component defined in the parent S2Container. For example, even if HelloImpl is defined in root.dicon, it will not be automatically injected into AaaHelloClient.</P>
            <H5>Result of BbbHelloClient</H5><PRE>Hello Bbb!
</PRE>
            <P>Similar to the case with AaaHelloClient, BbbHelloClient uses HelloImpl component defined in bbb.dicon.<BR />
Files is this example are contained in the s2container.php5/src/examples/dicon/include folder.</P><A name=Namespace>
            <H3>Namespace</H3></A>
            <P>Namespace is used to distinguish component definitions from several configuration file. Namespace is specified by namespace attribute of a <A href="#componentsTag">components tag</A>.</P>
            <H5>foo.dicon</H5><PRE>&lt;components namespace="foo"&gt;
    &lt;component name="aaa" .../&gt;
    &lt;component name="bbb" ...&gt;
        &lt;arg&gt;aaa&lt;/arg&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <H5>bar.dicon</H5><PRE>&lt;components namespace="bar"&gt;
    &lt;include path="foo.dicon"/&gt;
    &lt;component name="aaa" .../&gt;
    &lt;component name="bbb" ...&gt;
        &lt;arg&gt;aaa&lt;/arg&gt;
    &lt;/component&gt;
    &lt;component name="ccc" ...&gt;
        &lt;arg&gt;foo.aaa&lt;/arg&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <H5>app.dicon</H5><PRE>&lt;components&gt;
    &lt;include path="bar.dicon"/&gt;
&lt;/components&gt;
</PRE>
            <P>Namespace is not necessary to require to reference components in the same S2Container. To reference components in other S2Container, however, namespace prefix associated with the S2Container is prepended to the component name. For example, foo.aaa and bar.aaa have the same component name "aaa" but have different namespace prefix. Thus, they are treated as two different components.<BR />
It is a convention to name the configuration file <SPAN class="enter">namespace</SPAN>.dicon.</P><A name=InstanceMode>
            <H3>Instance Management</H3></A>
            <P>instance attribute of a <A href="#componentTag">component tag</A> specifies how component instance is managed by a S2Container. Default is singleton which implies S2Container#getComponent() method always gets the same component. To get a new component each time S2Container#getComponent() method is invoked, set the instance attribute to <SPAN class="enter">prototype</SPAN>. To manage component based on request ($_REQUEST), set the instance attribute to <SPAN class="enter">request</SPAN>. To manage based on a session, set the instance attribute to <SPAN class="enter">session</SPAN>.</P>
            <P>When using Seasar framework with a presentation framework, there may sometimes be a need to set an instance created by a presentation framework to a component managed by S2Container. In this kind of circumstances where <A href="http://www.martinfowler.com/articles/injection.html">Dependency Injection</A> to a component outside the S2Container is necessary, the following method are used.<BR><BR>- S2Container#injectDependency($outerComponent, $componentKey)</P>Specify external component in the first argument and external component class or component name in the second argument.<BR>Also, set instance attribute to <SPAN class="enter">outer</SPAN> in S2Container definition.<BR><BR>
            <TABLE width=744 border=1>
              <TBODY>
              <TR align=middle bgColor=#d1f3f4>
                <TH scope=col width=104>instance attribute</TH>
                <TH scope=col width=624>Description</TH></TR>
              <TR>
                <TD>singleton (default)</TD>
                <TD>Same instance is returned on every invocation of S2Container#getComponent()</TD></TR>
              <TR>
                <TD>prototype</TD>
                <TD>New instance is returned on each invocation of S2Container#getComponent()</TD></TR>
              <TR>
                <TD>request</TD>
                <TD>One instance is created for each request. A component is saved to a request using the name set to the name attribute.</TD></TR>
              <TR>
                <TD>session</TD>
                <TD>One instance is created for each session. A component is saved to a session using the name set to the name attribute.</TD></TR>
              <TR>
                <TD>outer</TD>
                <TD>Instance of a component is created outside of S2Container. Only dependency is injected. <A href="#Aop">Aspect</A> and <A href="#ConstructorInjection">Constructor injection</A> can not be applied.</TD></TR></TBODY></TABLE><A name=Lifecycle>
            <H3>Lifecycle</H3></A>
            <P>Using initMethod and destroyMethod, component lifecycle may also be managed by a container. Method specified by <A href="#initMethodTag">initMethod tag</A> is invoked when S2Container is initialized (S2Container#init()) and method specified by <A href="#destroyMethodTag">destroyMethod tag</A> is invoked when S2Container is destroyed (S2Container#destroy()). initMethod is executed in order as they are defined in the container configuration and destroyMethod is executed in reverse order as they are defined in the container configuration.<BR>When instance attribute is not "singleton", destroyMethod is ignored. Following is an example to set aaa to 111 on initialization and set aa to null termination to HashMap#put method.</P><PRE>&lt;components namespace="bar"&gt;
    &lt;component name="map" class="HashMap"&gt;
        &lt;initMethod name="put"&gt;
            &lt;arg&gt;"aaa"&lt;/arg&gt;
            &lt;arg&gt;111&lt;/arg&gt;
        &lt;/initMethod&gt;
        &lt;destroyMethod name="put"&gt;
            &lt;arg&gt;"aaa"&lt;/arg&gt;
            &lt;arg&gt;null&lt;/arg&gt;
        &lt;/destroyMethod&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE><A name=AutoBindingMode>
            <H3>Automatic Binding</H3></A>
            <P>By default, dependency between container is automatically resolved when type is an interface. It is also possible to specify autoBinding attribute in a <A href="#componentTag">component tag</A>.</P>
            <TABLE width=744 border=1>
              <TBODY>
              <TR align=middle bgColor=#d1f3f4>
                <TH scope=col width=104>autoBinding</TH>
                <TH scope=col width=624>Description</TH></TR>
              <TR>
                <TD>auto (default)</TD>
                <TD>If an argument to a constructor is explicity specified, that argument is used.<BR />Is an argument is not specified and type is an interface,it is automatically bound.<BR />Default values are set to arguments whose type is not an interface. If default value is not available, an argument is set to null.<BR>If a property is explicitly specified, it is used.<BR />If property is not specified and property type is an interface, it is automatically bound.</TD></TR>
              <TR>
                <TD>constructor</TD>
                <TD>If an argument to a constructor is explicitly specified, that argument is used.<BR>Is an argument is not specified and type is an interface,it is automatically bound.<BR>Default values are set to arguments whose type is not an interface. If default value is not available, an argument is set to null.<BR>If a property is explicitly specified, it is used.</TD></TR>
              <TR>
                <TD>property</TD>
                <TD>If an argument to a constructor is explicitly specified, that argument is used.<BR>Type interface property is automatically bound</TD></TR>
              <TR>
                <TD>none</TD>
                <TD>If an argument to a constructor is explicitly specified, that argument is used.<BR>If a property is explicitly specified, it is used.</TD></TR></TBODY></TABLE><BR>
            <P>Refer to <A href="#AutoConstructorInjectionEx">Automatically binding (constructor injection)</A> and <A href="#AutoSetterInjectionEx">Automatically binding (setter injection)</A> for further details.</P><A name=UseS2Container>
            <H3>Using S2Container from a component</H3></A>
            <P>Component should not depend on a S2Container but there are some situations where a component may need to invoke S2Container method. S2Container is defined with a name "container" so is the value of arg or property tag is set to "container" it is possible to get an instance of a container. Furthermore, it is also possible to automatically bind by defining a S2Container type setter method. Following are examples of using arg and property tag to specify "container".</P><PRE>&lt;components&gt;
    &lt;component class="BarImpl"&gt;
        &lt;arg&gt;container&lt;/arg&gt;
    &lt;/component&gt;

    &lt;component class="FooImpl"&gt;
        &lt;property name="foo"&gt;container&lt;/property&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE><A name=Aop>
            <H3>Applying AOP</H3></A>
            <P><A href="aop.html">AOP</A> may be applied to a component. Following is an example of applying <A href="aop.html#TraceInterceptor">TraceInterceptor</A> to a Date class.</P><PRE>&lt;?php
class Date {
    function Date() {}
    
    function getTime(){
        return '12:00:30';
    }
}
?&gt;
</PRE><PRE>&lt;components&gt;
    &lt;component name="traceInterceptor"
               class="TraceInterceptor"/&gt;
    &lt;component class="Date"&gt;
        &lt;aspect&gt;traceInterceptor&lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <P>Specify <A href="aop.html#AOPInterceptor">Interceptor</A> name as the value of aspect tag. Method names separated by a comma may be specified in pointcut attribute. When pointcut attribute is not specified, all interfaces implemented by a component is used. Method names may be specified using a regular expression. Following is an example using the above component definition.</P><PRE>&lt;?php
$PATH ="Aop.dicon";
$container = S2ContainerFactory::create($PATH);
$date = $container-&gt;getComponent('Date');
$date-&gt;getTime();
?&gt;
</PRE>
            <P>Following is a sample output from executing the above script.</P><PRE>BEGIN Date#getTime()
END   Date#getTime() : 12:00:30
</PRE><A name=Meta>
            <H3>MetaData</H3></A>
            <P>meta data may be applied to components, component, arg, and property tags. meta tag is specified as a child element to the element which is to have a meta tag. Following is an example of specifying a meta tag to a components tag.</P><PRE>&lt;components&gt;
    &lt;meta name="aaa"&gt;111&lt;/meta&gt;
&lt;/components&gt;
</PRE>
            <P>Meta data information specified in components, component, arg, and property tags may be retrieved using the following methods defined in S2Container, ComponentDef, ArgDef, and PropertyDef.</P>
            <UL>
              <LI>public function getMetaDefSize() 
              <LI>public function getMetaDef($name) </LI></UL><BR><A name=DefReference>
            <H2>S2Container Definition Reference</H2></A><A name=DOCTYPE>
            <H3>DOCTYPE</H3></A>
            <P>DOCTYPE is specified right after XML declaration. Following is an example of a component configuration with a DOCTYPE declaration:</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component name="hello" class="HelloConstructorInjection"&gt;
        &lt;arg&gt;"Hello World!"&lt;/arg&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE><A name=componentsTag>
            <H3>components tag (required)</H3></A>
            <P>Root element</P><A name=namespaceAttr>
            <H4>namespace attribute (optional)</H4></A>
            <P><A href="#Namespace">Namespace</A> may be specified. Namespace may also be used to differentiate PHP elements.</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components namespace="hoge"&gt;
    ...
&lt;/components&gt;
</PRE><A name=includeTag>
            <H3>include tag (optional)</H3></A>
            <P>Used to <A href="#Include">include</A> divided S2Container configuration definitions</P><A 
            name=pathAttr>
            <H4>path attribute (required)</H4></A>
            <P>Specify a path of the configuration file. Must be inserted before a component tag. Full path of a configuration file must be specified. Path may be represented by a constant defined in a PHP by surrounding the constant name with a <SPAN class="enter">%</SPAN>.</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;include path="path/to/ccc.dicon" /&gt;
    &lt;include path="%DICON_DIR%/ddd.dicon" /&gt;
&lt;/components&gt;
</PRE><A name=componentTag>
            <H3>component tag (optional)</H3></A>
            <P>Define a component</P><A name=classAttr>
            <H4>class attribute (optional)</H4></A>
            <P>Specify a class name. If a component is specified using a PHP expression as a value to an element, class attribute may be omitted. If class attribute is specified when PHP expression is used, it will be type checked.</P><A name=componentTag.nameAttr>
            <H4>name attribute (optional)</H4></A>
            <P>Name may be specified. The name should be choosen so it may be used as a PHP key. Refer to <A href="#getComponent">Getting a Component</A> for further details.</P><A name=instanceAttr>
            <H4>instance attribute (optional)</H4></A>
            <P>Specify how S2Container manages instance of a component. Possible values are singleton (default), prototype, outer, request, and session. Refer to <A href="#InstanceMode">instance management</A> for further details on these values.</P><A name=autoBindingAttr>
            <H4>autoBinding attribute (optional)</H4></A>
            <P>Specify how S2Container resolves dependencies between components. Possible values are auto (default), constructor, property, and none. Refer to <A href="#AutoBindingMode">automatic binding</A> for further details on these values.</P><A name=argTag>
            <H3>arg tag (optional)</H3></A>
            <P>Used to specify arguments to a constructor when added as an child element to a <A href="#componentTag">component</A> element. The order they are specified represents their position in the argument.<BR />
When used as a child element to <A href="#initMethodTag">initMethod</A> element or a <A href="#destroyMethodTag">destroyMethod</A> element, value of an arg element is passes as an argument to the method. The order they are specified represents their position in the argument. A value to be passes as an argument may be written in PHP expression and set as a value of an element or set in a child <A href="#componentTag">component</A> element.</P><A name=propertyTag>
            <H3>property tag (optional)</H3></A>
            <P>Used as a child of <A href="#componentTag">component</A> element. Value of the property may be written in PHP expression and set to as a value of an element or set in a child <A href="#componentTag">component</A> element.</P><A name=propertyTag.nameAttr>
            <H4>name attribute (optional)</H4></A>
            <P>Specify property name.</P><A name=metaTag>
            <H3>meta tag (optional)</H3></A>
            <P>Used as a child element to <A href="#componentsTag">components</A> element, <A href="#componentTag">component</A> element, <A href="#argTag">arg</A> element, and <A href="#propertyTag">property</A> element. Value of the meta data may be written in PHP expression and set to as a value of an element or set in a child <A href="#componentTag">component</A> element.</P><A name=propertyTag.nameAttr>
            <H4>name attribute (optional)</H4></A>
            <P>Specify meta name.</P><A name=initMethodTag>
            <H3>initMethod tag (optional)</H3></A>
            <P>Used as a child element of a <A href="#componentTag">component element</A>. Arguments are specified in child <A href="#argTag">arg</A> elements. Method in a component may be invoked without specifying name attribute using PHP expression. $component represents the component defining the initMethod element. $component may be used as an object only within the initMethod element.</P><A name=initMethodTag.nameAttr>
            <H4>name attribute (optional)</H4></A>
            <P>Specify method name.</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component class="HashMap"&gt;
        &lt;initMethod name="put"&gt;
            &lt;arg&gt;"aaa"&lt;/arg&gt;
            &lt;arg&gt;111&lt;/arg&gt;
        &lt;/initMethod&gt;
        &lt;initMethod&gt;$component-&gt;put("aaa", 111);&lt;/initMethod&gt;
        &lt;initMethod&gt;print "Hello";&lt;/initMethod&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE><A name=destroyMethodTag>
            <H3>destroyMethod tag (optional)</H3></A>
            <P>same as initMethod tag</P><A name=aspectTag>
            <H3>aspect tag (optional)</H3></A>
            <P>Weave aspect into a component. Refer to <A href="aop.html#AOPExplanationFile">aspect tag</A> for detailed explanation.</P><A 
            name=descriptionTag>
            <H3>description tag (optional)</H3></A>
            <P>Description element may be used as a child to <A href="#componentsTag">components</A> element, <A href="#componentTag">component</A> element, <A href="#argTag">arg</A> element, and <A href="#propertyTag">property</A> element to write a comment.</P><BR><A name=Example>
            <H2>Examples</H2></A>
            <P>S2Container.PHP must be <A href="setup.html">setup</A> before running the following examples.</P><A 
            name=ConstructorInjectionEx>
            <H3>Constructor Injection</H3></A>
            <P>Use constructor injection to display a message. Following files are created in this example:</P>
            <UL>
              <LI type=circle>Interface (Hello.class.php) 
              <LI type=circle>Implementation class (HelloConstructorInjection.class.php) 
              <LI type=circle>dicon file (HelloConstructorInjection.dicon) 
              <LI type=circle>Execution script (HelloConstructorInjectionClient.php) 
            </LI></UL>
            <H5>Create interface</H5>
            <UL>
              <LI type=circle>Define showMessage()</LI></UL>
            <P>Let's start by defining interfaces. By separating interfaces with their implementation, components only have to be concerned about the interface and not their implementation. Additionally, implementation may be replaced with a mock to make unit testing easier.</P><PRE>&lt;?php
interface Hello {
    public function showMessage();
}
?&gt;
</PRE>
            <H5>Create implementation class</H5>
            <UL>
              <LI type=circle>Define a constructor with one argument
              <LI type=circle>Implement showMessage()</LI></UL>
            <P>Next, we'll do implement the interfaces. The constructor of the class will accept a message and output the message using the showMessage() method.</P><PRE>&lt;?php
class HelloConstructorInjection implements Hello {
    private $message;

    public function HelloConstructorInjection($message) {
        $this-&gt;message = $message;
    }

    public void showMessage() {
        print $this-&gt;message . "\n";
    }
}
?&gt;
</PRE>
            <H5>Create dicon file</H5>
            <UL>
              <LI type=circle>Define a component using <A href="#componentTag">component tag</A>
              <LI type=circle>Set an argument by creating an <A href="#argTag">arg</A>element that is a child element to a component element.
              </LI></UL>
            <P>S2Container is responsible for setting the message to a component. Components are created based on the configuration file.<BR><BR>s2container.php5/src/examples/dicon/HelloConstructorInjection.dicon</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component name="hello" class="HelloConstructorInjection"&gt;
        &lt;arg&gt;"Hello World!"&lt;/arg&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Create a S2Container by invoking on <A href="#S2ContainerCreation">S2ContainerFactory#create($path)</A>.

              <LI type=circle>Get the component from S2Container by using <A href="#getComponent">getComponent()</A> method.
              <LI type=circle>Invoke a method in component gotton from the S2Container.</LI></UL>
            <P>s2container.php5/src/examples/dicon/HelloConstructorInjectionClient.php</P><PRE>&lt;?php
require_once(dirname(__FILE__) . '/example.inc.php');
$PATH =	EXAMPLE_DIR . "/dicon/HelloConstructorInjection.dicon";
		
$container = S2ContainerFactory::create($PATH);
$hello = $container-&gt;getComponent('Hello');
$hello-&gt;showMessage();
		
$hello2 = $container-&gt;getComponent("hello");
$hello2-&gt;showMessage();
?&gt;
</PRE>
            <H5>Result</H5>
            <P>String value in the arg tag should be displayed as below:</P><PRE>% php HelloConstructorInjectionClient.php
Hello World!
Hello World!
%
</PRE>
            <P>Files in this example are available in the s2container.php5/src/examples/dicon folder.</P><A name=SetterInjectionEx>
            <H3>Setter Injection</H3></A>
            <P>Display a message using setter injection. Following files are created in this example:</P>
            <UL>
              <LI type=circle>Interface (Hello.class.php) 
              <LI type=circle>Implementation class (HelloSetterInjection.class.php) 
              <LI type=circle>dicon file (HelloSetterInjection.dicon) 
              <LI type=circle>Execution script (HelloSetterInjectionClient.php) </LI></UL>
            <H5>Create interface</H5>
            <UL>
              <LI type=circle>Define showMessage()</LI></UL>
            <P>Interface is the same as constructor injection. There is no need to define getter method and setter method to a property. This is because whether to use constructor or setter method to inject dependency should be decided by the implementation.</P><PRE>&lt;?php
interface Hello {
    public void showMessage();
}
?&gt;
</PRE>
            <H5>Create an implementation class</H5>
            <UL>
              <LI type=circle>Define setter method (setMessage)
              <LI type=circle>Implement showMessage()</LI></UL>
            <P>We'll tackle the implementation next. Message is received by the setter method and outputted by the showMessage() method.</P><PRE>&lt;?php
class HelloSetterInjection implements Hello {
    private $message;

    public function HelloSetterInjection() {
    }

    public function setMessage($message) {
        $this-&gt;message = $message;
    }

    public function showMessage() {
        print $this-&gt;message . "\n";
    }
}
?&gt;
</PRE>
            <H5>Create dicon file</H5>
            <UL>
              <LI type=circle>Define component using <SPAN class="enter">component</SPAN> tag
              <LI type=circle>Define component property in <A href="#propertyTag">property</A> element which is a child of a component element.
              </LI></UL>
            <P>s2container.php5/src/examples/dicon/HelloSetterInjection.dicon</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component class="HelloSetterInjection"&gt;
        &lt;property name="message"&gt;"Hello World!"&lt;/property&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Invoke S2ContainerFactory#create($path) and create S2Container
              <LI type=circle>Use getComponent() and get component from the S2Container
              <LI type=circle>Invoke on the method in the component from S2Container</LI></UL>
            <P>s2container.php5/src/examples/dicon/HelloSetterInjectionClient.php</P><PRE>&lt;?php
require_once(dirname(__FILE__) . '/example.inc.php');
$PATH = EXAMPLE_DIR . "/dicon/HelloSetterInjection.dicon";
		
$container = S2ContainerFactory::create($PATH);
$hello = $container-&gt;getComponent('Hello');
$hello-&gt;showMessage();
?&gt;
</PRE>
            <H5>Result</H5>
            <P>String specified in the property tag is displayed as below:</P><PRE>% php HelloSetterInjectionClient.php
Hello World!
%
</PRE>
            <P>Files in this example are available in the s2container.php5/src/examples/dicon folder.</P><A name=MethodInjectionEx>
            <H3>Method Injection</H3></A>
            <P>Display a message using method injection. Following files are created in this example:</P>
            <UL>
              <LI type=circle>Interface (Hello.class.php) 
              <LI type=circle>Implementation class (HelloMethodInjection.class.php) 
              <LI type=circle>dicon file (HelloMethodInjection.dicon) 
              <LI type=circle>Execution script (HelloMethodInjectionClient.php) </LI></UL>
            <H5>Create interface</H5>
            <UL>
              <LI type=circle>Define showMessage()</LI></UL>
            <P>In most cases, injected method is called several but in this example, the same interface as the constructor injection example is used.
            </P><PRE>&lt;?php
interface Hello {
    public function showMessage();
}
?&gt;
</PRE>
            <H5>Create implementation class</H5>
            <UL>
              <LI type=circle>Define addMessage()
              <LI type=circle>Implement showMessage()</LI></UL>
            <P>Next, it's implementation. Use addMessage($message) to add messages several times, and display received messages by using showMethod().</P><PRE>&lt;?php
class HelloMethodInjection implements Hello {
    private $buf = "";
	
    public function HelloMethodInjection() {}
	
    public function addMessage($message) {
        $this-&gt;buf .= $message;
    }

    public function showMessage() {
        print $this-&gt;buf . "\n";
    }
}
?&gt;
</PRE>
            <H5>Create dicon file</H5>
            <UL>
              <LI type=circle>Define component using <SPAN class="enter">component</SPAN> tag
              <LI type=circle>Define arguments for a method in a component in <A href="#initMethodTag">initMethod</A> element which is a child element of a component element.
              </LI></UL>
            <P>First, use arg tag to set String "Hello" to ddMessage($message).<BR>Next, use PHP expression to set "World!" to addMessage($message).<BR><BR>s2container.php5/src/examples/dicon/HelloMethodInjection.dicon</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component class="HelloMethodInjection"&gt;
        &lt;initMethod name="addMessage"&gt;
            &lt;arg&gt;"Hello "&lt;/arg&gt;
        &lt;/initMethod&gt;
        &lt;initMethod&gt;$component-&gt;addMessage("World!")&lt;/initMethod&gt;
    &lt;/component&gt;
&lt;/components&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Invoke S2ContainerFactory#create($path) to create S2Container
              <LI type=circle>Invoke getComponent() to get a component from the S2Container
              <LI type=circle>Invoke the method in the component from S2Container</LI></UL><PRE>&lt;?php
require_once(dirname(__FILE__) . '/example.inc.php');
$PATH = EXAMPLE_DIR . "/dicon/HelloMethodInjection.dicon";
		
$container = S2ContainerFactory::create($PATH);
$hello = $container-&gt;getComponent('Hello');
$hello-&gt;showMessage();
?&gt;
</PRE>
            <H5>Result</H5>
            <P>String set as the value to initMethod element should display as below:</P><PRE>% php HelloMethodInjectionClient.php
Hello World!
%
</PRE>
            <P>Files in this example are available in the s2container.php5/src/examples/dicon folder.</P><A name=AutoConstructorInjectionEx>
            <H3>Automatic binding (constructor injection)</H3></A>
            <P>Let's display a message using automatic binding. Following files are created in this example:</P>
            <UL>
              <LI type=circle>Interface (Hello.class.php) 
              <LI type=circle>Implementation class of an interface(AutoHelloConstructorInjection.class.php) 
              <LI type=circle>Map interface (Map.class.php) 
              <LI type=circle>Implementation class of a Map interface (HashMap.class.php)
              <LI type=circle>dicon file (AutoHelloConstructorInjection.dicon) 
              <LI type=circle>Execution script (AutoHelloConstructorInjectionClient.php) 
              </LI></UL>
            <H5>Create an interface</H5>
            <UL>
              <LI type=circle>Define showMessage()</LI></UL><PRE>&lt;?php
interface Hello {
    public function showMessage();
}
?&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Define construction with argument Map
              <LI type=circle>Implement showMessage()</LI></UL>
            <P>Receive Map from a constructor, use "hello" as a key to showMessage() method to retrieve message from a Map, and output the message.</P><PRE>&lt;?php
class AutoHelloConstructorInjection implements Hello {

    private $messages;
	
    public function AutoHelloConstructorInjection(Map $messages) {
        $this-&gt;messages = $messages;
    }
	
    public function showMessage() {
        print $this-&gt;messages-&gt;get('hello') . "\n";
    }
}
?&gt;
</PRE>
            <H5>Create Map interface</H5>
            <UL>
              <LI type=circle>Define put($key,$val)
              <LI type=circle>Define get($key)</LI></UL><PRE>&lt;?php
interface Map {
    function put($key,$val);
    function get($key);
}
?&gt;
</PRE>
            <H5>Create implementation class of Map interface</H5>
            <UL>
              <LI type=circle>Define constructor with argument Map
              <LI type=circle>Implement showMessage()</LI></UL><PRE>&lt;?php
class HashMap implements Map{
    private $pool = array();
    
    function HashMap() {}
    
    function put($key,$val){
    	$this-&gt;pool[$key] = $val;
    }
    
    function get($key){
    	return array_key_exists($key,$this-&gt;pool) ? $this-&gt;pool[$key] : null;
    }
}
?&gt;
</PRE>
            <H5>Create dicon file</H5>
            <UL>
              <LI type=circle>Define HashMap, which is a specified in a <A href="#componentTag">component</A> tag as a implementation class of Map, as a component
              <LI type=circle>Define a HashMap with key "hello" and value "Hello World!" in a <A href="#initMethodTag">initMethod</A> element which is a child of component element.
              <LI type=circle>Define a component AutoHelloConstructorInjection in a component tag. Set autoBinding attribute to "auto".<BR>We are explicitly setting "auto" to yes but since this is the default value of autoBinding attribute, it is not required.</LI></UL>
            <P>Notice that the arg tag does not have a definition of AutoHelloConstructorInjection. arg tag definition is required in a constructor injection but if there is a implementation class of a Map in S2Container, S2Container will search the container and set the argument. However, if the argument type is not a interface, that argument is not automatically bound.<BR><BR>s2container.php5/src/examples/dicon/autobinding/AutoHelloConstructorInjection.dicon</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component class="HashMap"&gt;
        &lt;initMethod name="put"&gt;
            &lt;arg&gt;"hello"&lt;/arg&gt;
            &lt;arg&gt;"Hello World!"&lt;/arg&gt;
        &lt;/initMethod&gt;
    &lt;/component&gt;

    &lt;component autoBinding="auto"
               class="AutoHelloConstructorInjection"/&gt;
&lt;/components&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Invoke <A href="#S2ContainerCreation">S2ContainerFactory#create($path) and create S2Container</A>。 
              <LI type=circle>Invoke <A href="#getComponent">getComponent()</a> to get a component from the S2Container</A>。 
              <LI type=circle>Invoke the method in the component from S2Container</LI></UL><PRE>&lt;?php
require_once(dirname(dirname(__FILE__)) . '/example.inc.php');
$PATH =	EXAMPLE_DIR . "/dicon/autobinding/AutoHelloConstructorInjection.dicon";
		
$container = S2ContainerFactory::create($PATH);
$hello = $container-&gt;getComponent('Hello');
$hello-&gt;showMessage();
?&gt;
</PRE>
            <H5>Result</H5>
            <P>Value set in the HashMap is display as below showing constructor argument was automatically bound.</P><PRE>% php AutoHelloConstructorInjection.php
Hello World!
%
</PRE>
            <P>Files in this example are available in the s2container.php5/src/examples/dicon/autobinding folder.</P><A name=AutoSetterInjectionEx>
            <H3>Automatic binding (setter injection)</H3></A>
            <P>Display message using automatic binding. Following files are created in this example:</P>
            <UL>
              <LI type=circle>Interface (Hello.class.php) 
              <LI type=circle>Implementation class of an interface (AutoHelloSetterInjection.class.php) 
              <LI type=circle>dicon file (AutoHelloSetterInjection.dicon) 
              <LI type=circle>Execution script (AutoHelloSetterInjectionClient.php) 
            </LI></UL>
            <H5>Create an interface</H5>
            <UL>
              <LI type=circle>Define showMessage()</LI></UL><PRE>&lt;?php
interface Hello {
    public function showMessage();
}
?&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Implement showMessage() with argument Map</LI></UL>
            <P>Retrieve Map from setMessage(Map map) and output the value retrieve value from a Map with key "hello" using showMessage()</P><PRE>&lt;?php
class AutoHelloSetterInjection implements Hello {

    private $messages;
	
    public function AutoHelloSetterInjection() {}
	
    public function setMessage(Map $messages) {
        $this-&gt;messages = $messages;
    }

    public function showMessage() {
        print $this-&gt;messages-&gt;get('hello') . "\n";
    }
}
?&gt;
</PRE>
            <H5>Create dicon file</H5>
            <UL>
              <LI type=circle>Define HashMap as a component in a <A href="#componentTag">component tag</A>.
              <LI type=circle>Define a HashMap with key "hello" and value "Hello World!" in a <A href="#initMethodTag">initMethod</A> element which is a child of component element.
              <LI type=circle>Define a component AutoHelloSetterInjection in a component tag. Set autoBinding attribute to "auto".<BR>We are explicitly setting "auto" to yes but since this is the default value of autoBinding attribute, it is not required.</LI></UL>
            <P>Notice that the property tag does not have a definition of AutoHelloSetterInjection. 
property tag definition may be required but if there is a implementation class of a Map in S2Container, S2Container will search the container and set the parameter. However, if the property type is not a interface, that property is not automatically bound.<BR><BR>s2container.php5/src/examples/dicon/autobinding/AutoHelloSetterInjection.dicon</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component class="HashMap"&gt;
        &lt;initMethod name="put"&gt;
            &lt;arg&gt;"hello"&lt;/arg&gt;
            &lt;arg&gt;"Hello World!"&lt;/arg&gt;
        &lt;/initMethod&gt;
    &lt;/component&gt;

    &lt;component autoBinding="auto"
               class="AutoHelloSetterInjection"/&gt;
&lt;/components&gt;
</PRE>
            <H5>Create execution script</H5>
            <UL>
              <LI type=circle>Create S2Container by using <A href="#S2ContainerCreation">S2ContainerFactory#create($path)</A>。 
              <LI type=circle>Use getComponent() method to <A href="#getComponent">get component from S2Container</A>
              <LI type=circle>Invoke method in a component from the S2Container</LI></UL><PRE>&lt;?php
require_once(dirname(dirname(__FILE__)) . '/example.inc.php');
$PATH = EXAMPLE_DIR . "/dicon/autobinding/AutoHelloSetterInjection.dicon";
		
$container = S2ContainerFactory::create($PATH);
$hello = $container-&gt;getComponent('Hello');
$hello-&gt;showMessage();
?&gt;
</PRE>
            <H5>Result</H5>
            <P>Value of HashMap is displayed showing the property was automatically set.</P><PRE>% php AutoHelloSetterInjection.php
Hello World!
%
</PRE>
            <P>Files in this example are available in the s2container.php5/src/examples/dicon/autobinding folder.</P><BR><!-- document end --><!-- don't edit start --></TD>
          <TD width=14><IMG height=14 alt="" 
            src="../images/spacer.gif" width=14></TD></TR>
        <TR>
          <TD width=14><IMG height=30 alt="" 
            src="../images/spacer.gif" width=14></TD>
          <TD width=766><IMG height=30 alt="" 
            src="../images/spacer.gif" width=592></TD></TR>
        <TR>
          <TD width=14><IMG height=14 alt="" 
            src="../images/spacer.gif" width=14></TD>
<TD class=copyright><TABLE cellSpacing=0 cellPadding=0 width=736><TR><TD align="left">Trans. by H.Ozawa</TD><TD align="right">Copyright&copy; 2004-2005, The Seasar Foundation and 
            the others. All rights reserved.</TD></TR></TABLE></TD></TR></TBODY></TABLE></TD>
    <TD class=backright vAlign=top align=left>&nbsp;</TD></TR>
  <TR>
    <TD class=backunder vAlign=top align=left width=780 height=16>&nbsp;</TD>
    <TD class=backcorner vAlign=top align=left 
height=16>&nbsp;</TD></TR></TBODY></TABLE><!-- don't edit end --></BODY></HTML>
